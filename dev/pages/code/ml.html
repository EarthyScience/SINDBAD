<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SINDBAD</title>
    <meta name="description" content="A model data integration framework">
    <meta name="generator" content="VitePress v1.6.3">
    <link rel="preload stylesheet" href="/Sindbad/assets/style.Cqd4DD2T.css" as="style">
    <link rel="preload stylesheet" href="/Sindbad/vp-icons.css" as="style">
    
    <script type="module" src="/Sindbad/assets/app.OodSL-12.js"></script>
    <link rel="preload" href="/Sindbad/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/Sindbad/assets/chunks/theme.B3x0wOVm.js">
    <link rel="modulepreload" href="/Sindbad/assets/chunks/framework.C07RQYAL.js">
    <link rel="modulepreload" href="/Sindbad/assets/pages_code_ml.md.Bs-fMNT9.lean.js">
    <link rel="icon" href="/favicon.ico">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-a9a9e638><!--[--><!--]--><!--[--><span tabindex="-1" data-v-492508fc></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-492508fc>Skip to content</a><!--]--><!----><header class="VPNav" data-v-a9a9e638 data-v-f1e365da><div class="VPNavBar" data-v-f1e365da data-v-822684d1><div class="wrapper" data-v-822684d1><div class="container" data-v-822684d1><div class="title" data-v-822684d1><div class="VPNavBarTitle has-sidebar" data-v-822684d1 data-v-0f4f798b><a class="title" href="/Sindbad/" data-v-0f4f798b><!--[--><!--]--><!--[--><img class="VPImage logo" src="/Sindbad/logo.png" width="24" height="24" alt data-v-35a7d0b8><!--]--><span data-v-0f4f798b>SINDBAD</span><!--[--><!--]--></a></div></div><div class="content" data-v-822684d1><div class="content-body" data-v-822684d1><!--[--><!--]--><div class="VPNavBarSearch search" data-v-822684d1><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-822684d1 data-v-e6d46098><span id="main-nav-aria-label" class="visually-hidden" data-v-e6d46098> Main Navigation </span><!--[--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Concept</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/concept/overview" data-v-acbfed09><!--[--><span data-v-acbfed09>SINDBAD</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/concept/experiment" data-v-acbfed09><!--[--><span data-v-acbfed09>Experiment</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/concept/TEM" data-v-acbfed09><!--[--><span data-v-acbfed09>TEM</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/concept/info" data-v-acbfed09><!--[--><span data-v-acbfed09>info</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/concept/land" data-v-acbfed09><!--[--><span data-v-acbfed09>land</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Manual</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/manual/array_handling" data-v-acbfed09><!--[--><span data-v-acbfed09>Array Handling</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/manual/experiments" data-v-acbfed09><!--[--><span data-v-acbfed09>Experiments</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/manual/conventions" data-v-acbfed09><!--[--><span data-v-acbfed09>Modeling Convention</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/manual/spinup" data-v-acbfed09><!--[--><span data-v-acbfed09>Spinup</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/manual/toy_model" data-v-acbfed09><!--[--><span data-v-acbfed09>Toy Model</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/manual/install" data-v-acbfed09><!--[--><span data-v-acbfed09>Install</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Settings</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/settings/overview" data-v-acbfed09><!--[--><span data-v-acbfed09>Overview</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/settings/experiment" data-v-acbfed09><!--[--><span data-v-acbfed09>Experiments</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/settings/forcing" data-v-acbfed09><!--[--><span data-v-acbfed09>Forcing</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/settings/model_structure" data-v-acbfed09><!--[--><span data-v-acbfed09>Models</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/settings/optimization" data-v-acbfed09><!--[--><span data-v-acbfed09>Optimization</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/settings/parameters" data-v-acbfed09><!--[--><span data-v-acbfed09>Parameters</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>Code</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/code/sindbad" data-v-acbfed09><!--[--><span data-v-acbfed09>Sindbad</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/code/data" data-v-acbfed09><!--[--><span data-v-acbfed09> + Data</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/code/experiment" data-v-acbfed09><!--[--><span data-v-acbfed09> + Experiment</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/code/metrics" data-v-acbfed09><!--[--><span data-v-acbfed09> + Metrics</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link active" href="/Sindbad/pages/code/ml" data-v-acbfed09><!--[--><span data-v-acbfed09> + ML</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/code/models" data-v-acbfed09><!--[--><span data-v-acbfed09> + Models</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/code/optimization" data-v-acbfed09><!--[--><span data-v-acbfed09> + Optimization</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/code/setup" data-v-acbfed09><!--[--><span data-v-acbfed09> + Setup</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/code/tem" data-v-acbfed09><!--[--><span data-v-acbfed09> + TEM</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/code/utils" data-v-acbfed09><!--[--><span data-v-acbfed09> + Utils</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/code/visuals" data-v-acbfed09><!--[--><span data-v-acbfed09> + Visuals</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-e6d46098 data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><!----><span data-v-04f5c5e9>About</span><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><div class="items" data-v-7dd3104a><!--[--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/about/contact" data-v-acbfed09><!--[--><span data-v-acbfed09>Contact</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/about/license" data-v-acbfed09><!--[--><span data-v-acbfed09>License</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/about/publications" data-v-acbfed09><!--[--><span data-v-acbfed09>Publications</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/about/support" data-v-acbfed09><!--[--><span data-v-acbfed09>Support</span><!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-7dd3104a data-v-acbfed09><a class="VPLink link" href="/Sindbad/pages/about/team" data-v-acbfed09><!--[--><span data-v-acbfed09>Team</span><!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><!----><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-822684d1 data-v-af096f4a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-af096f4a data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-822684d1 data-v-164c457f data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/EarthyScience/SINDBAD" aria-label="repo address" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-822684d1 data-v-925effce data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-04f5c5e9><span class="vpi-more-horizontal icon" data-v-04f5c5e9></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--[--><!----><div class="group" data-v-925effce><div class="item appearance" data-v-925effce><p class="label" data-v-925effce>Appearance</p><div class="appearance-action" data-v-925effce><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-925effce data-v-e40a8bb6 data-v-4a1c76db><span class="check" data-v-4a1c76db><span class="icon" data-v-4a1c76db><!--[--><span class="vpi-sun sun" data-v-e40a8bb6></span><span class="vpi-moon moon" data-v-e40a8bb6></span><!--]--></span></span></button></div></div></div><div class="group" data-v-925effce><div class="item social-links" data-v-925effce><div class="VPSocialLinks social-links-list" data-v-925effce data-v-ee7a9424><!--[--><a class="VPSocialLink no-icon" href="https://github.com/EarthyScience/SINDBAD" aria-label="repo address" target="_blank" rel="noopener" data-v-ee7a9424 data-v-d26d30cb><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="VPFlyout VPNolebaseEnhancedReadabilitiesMenu VPNolebaseEnhancedReadabilitiesMenuFlyout" aria-label="Enhanced Readability" role="menuitem" data-v-04f5c5e9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-04f5c5e9><span class="text" data-v-04f5c5e9><span class="i-icon-park-outline:book-open option-icon" data-v-04f5c5e9></span><!----><span class="vpi-chevron-down text-icon" data-v-04f5c5e9></span></span></button><div class="menu" data-v-04f5c5e9><div class="VPMenu" data-v-04f5c5e9 data-v-7dd3104a><!----><!--[--><!--]--></div></div></div><!--]--><!--]--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-822684d1 data-v-5dea55bf><span class="container" data-v-5dea55bf><span class="top" data-v-5dea55bf></span><span class="middle" data-v-5dea55bf></span><span class="bottom" data-v-5dea55bf></span></span></button></div></div></div></div><div class="divider" data-v-822684d1><div class="divider-line" data-v-822684d1></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-a9a9e638 data-v-070ab83d><div class="container" data-v-070ab83d><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-070ab83d><span class="vpi-align-left menu-icon" data-v-070ab83d></span><span class="menu-text" data-v-070ab83d>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-070ab83d data-v-168ddf5d><button data-v-168ddf5d>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-a9a9e638 data-v-18756405><div class="curtain" data-v-18756405></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-18756405><span class="visually-hidden" id="sidebar-aria-label" data-v-18756405> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Concept</h2><!----></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/concept/overview" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>SINDBAD</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/concept/experiment" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Experiment</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/concept/TEM" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>TEM</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/concept/info" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>info</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/concept/land" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>land</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Manual</h2><!----></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/manual/array_handling" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Array Handling</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/manual/experiments" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Experiments</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/manual/conventions" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Modeling Convention</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/manual/spinup" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Spinup</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/manual/toy_model" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Toy Model</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/manual/install" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Install</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Settings</h2><!----></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/settings/overview" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Overview</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/settings/experiment" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Experiments</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/settings/forcing" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Forcing</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/settings/model_structure" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/settings/optimization" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Optimization</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/settings/parameters" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Parameters</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0 collapsible collapsed has-active" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>Code</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-a4b0d9bf><span class="vpi-chevron-right caret-icon" data-v-a4b0d9bf></span></div></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/code/sindbad" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Sindbad</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/code/data" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf> + Data</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/code/experiment" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf> + Experiment</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/code/metrics" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf> + Metrics</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/code/ml" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf> + ML</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/code/models" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf> + Models</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/code/optimization" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf> + Optimization</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/code/setup" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf> + Setup</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/code/tem" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf> + TEM</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/code/utils" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf> + Utils</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/code/visuals" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf> + Visuals</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-9e426adc><section class="VPSidebarItem level-0" data-v-9e426adc data-v-a4b0d9bf><div class="item" role="button" tabindex="0" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><h2 class="text" data-v-a4b0d9bf>About</h2><!----></div><div class="items" data-v-a4b0d9bf><!--[--><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/about/contact" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Contact</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/about/license" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>License</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/about/publications" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Publications</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/about/support" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Support</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-a4b0d9bf data-v-a4b0d9bf><div class="item" data-v-a4b0d9bf><div class="indicator" data-v-a4b0d9bf></div><a class="VPLink link link" href="/Sindbad/pages/about/team" data-v-a4b0d9bf><!--[--><p class="text" data-v-a4b0d9bf>Team</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-a9a9e638 data-v-91765379><div class="VPDoc has-sidebar has-aside" data-v-91765379 data-v-83890dd9><!--[--><!--]--><div class="container" data-v-83890dd9><div class="aside" data-v-83890dd9><div class="aside-curtain" data-v-83890dd9></div><div class="aside-container" data-v-83890dd9><div class="aside-content" data-v-83890dd9><div class="VPDocAside" data-v-83890dd9 data-v-6d7b3c46><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-6d7b3c46 data-v-b38bf2ff><div class="content" data-v-b38bf2ff><div class="outline-marker" data-v-b38bf2ff></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-b38bf2ff>On this page</div><ul class="VPDocOutlineItem root" data-v-b38bf2ff data-v-3f927ebe><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-6d7b3c46></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-83890dd9><div class="content-container" data-v-83890dd9><!--[--><!--]--><main class="main" data-v-83890dd9><div style="position:relative;" class="vp-doc _Sindbad_pages_code_ml" data-v-83890dd9><div><details class="jldocstring custom-block" open><summary><a id="SindbadML" href="#SindbadML"><span class="jlbinding">SindbadML</span></a> <span class="VPBadge info jlObjectType jlModule"><!--[-->Module<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SindbadML</span></span></code></pre></div><p>This package provides the tools to train neural networks to predict model parameters from <code>process-based models (PBMs)</code> using automatic differentiation and finite differences. It also includes functions to train PBMs using a mixed gradient approach to optimize the neural network weights and the PBM parameters simultaneously.</p><div class="danger custom-block"><p class="custom-block-title">DANGER</p><p>This package is still under development and is not yet ready for production use.</p></div></details><h2 id="exported" tabindex="-1">Exported <a class="header-anchor" href="#exported" aria-label="Permalink to &quot;Exported&quot;">​</a></h2><details class="jldocstring custom-block" open><summary><a id="SindbadML.JoinDenseNN-Tuple{Tuple}" href="#SindbadML.JoinDenseNN-Tuple{Tuple}"><span class="jlbinding">SindbadML.JoinDenseNN</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JoinDenseNN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(models</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>Arguments:</strong></p><ul><li>models :: a tuple of models, i.e. (m1, m2)</li></ul><p><strong>Returns:</strong></p><ul><li>all parameters as a vector or matrix (multiple samples)</li></ul><p><strong>Example</strong></p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SindbadML</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Flux</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Random</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Random</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">seed!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m_big </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Chain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, relu), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), Flux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sigmoid)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m_eta </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Flux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sigmoid)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x_big_a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Float32, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x_small_a1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Float32, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">x_small_a2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Float32, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">model </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JoinDenseNN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((m_big, m_eta))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">model</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((x_big_a, x_small_a2))</span></span></code></pre></div></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.denseNN-Tuple{Int64, Int64, Int64}" href="#SindbadML.denseNN-Tuple{Int64, Int64, Int64}"><span class="jlbinding">SindbadML.denseNN</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">denseNN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(in_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, n_neurons</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, out_dim</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; extra_hlayers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, activation_hidden</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Flux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">relu, activation_out</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Flux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sigmoid, seed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1618</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>Arguments</strong></p><ul><li><p><code>in_dim</code>: input dimension</p></li><li><p><code>n_neurons</code>: number of neurons in each hidden layer</p></li><li><p><code>out_dim</code>: output dimension</p></li><li><p><code>extra_hlayers</code>=0: controls the number of extra hidden layers, default is <code>zero</code></p></li><li><p><code>activation_hidden</code>=Flux.relu: activation function within hidden layers, default is Relu</p></li><li><p><code>activation_out</code>= Flux.sigmoid: activation of output layer, default is sigmoid</p></li><li><p><code>seed=1618</code>: Random seed, default is ~ (1+√5)/2</p></li></ul><p>Returns a <code>Flux.Chain</code> neural network.</p></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.destructureNN-Tuple{Any}" href="#SindbadML.destructureNN-Tuple{Any}"><span class="jlbinding">SindbadML.destructureNN</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">destructureNN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(model; nn_opt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Optimisers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Adam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span></code></pre></div><p>Given a <code>model</code> returns a <code>flat</code> vector with all weights, a <code>re</code> structure of the neural network and the current <code>state</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>model</code>: a Flux.Chain neural network.</p></li><li><p><code>nn_opt</code>: Optimiser, the default is <code>Optimisers.Adam()</code>.</p></li></ul><p>Returns:</p><ul><li><p>flat :: a flat vector with all network weights</p></li><li><p>re :: an object containing the model structure, used later to <code>re</code>construct the neural network</p></li><li><p>opt_state :: the state of the optimiser</p></li></ul></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.getInnerArgs-NTuple{17, Any}" href="#SindbadML.getInnerArgs-NTuple{17, Any}"><span class="jlbinding">SindbadML.getInnerArgs</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getInnerArgs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(idx, grads_lib, scaled_params_batch, parameter_scaling_type, selected_models, space_forcing, space_spinup_forcing, loc_forcing_t, space_output, loc_land, tem_info, param_to_index, parameter_scaling_type, space_observations, cost_options, constraint_method, indices_batch, sites_batch)</span></span></code></pre></div><p>Function to get inner arguments for the loss function.</p><p><strong>Arguments</strong></p><ul><li><p><code>idx</code>: index batch value</p></li><li><p><code>grads_lib</code>: gradient library</p></li><li><p><code>scaled_params_batch</code>: scaled parameters batch</p></li><li><p><code>selected_models</code>: selected models</p></li><li><p><code>space_forcing</code>: forcing data location</p></li><li><p><code>space_spinup_forcing</code>: spinup forcing data location</p></li><li><p><code>loc_forcing_t</code>: forcing data time for one time step.</p></li><li><p><code>space_output</code>: output data location</p></li><li><p><code>loc_land</code>: initial land state</p></li><li><p><code>tem_info</code>: model information</p></li><li><p><code>param_to_index</code>: parameter to index</p></li><li><p><code>parameter_scaling_type</code>: type determining parameter scaling</p></li><li><p><code>loc_observations</code>: observation data location</p></li><li><p><code>cost_options</code>: cost options</p></li><li><p><code>constraint_method</code>: constraint method</p></li><li><p><code>indices_batch</code>: indices batch</p></li><li><p><code>sites_batch</code>: sites batch</p></li></ul></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.getLossForSites-Union{Tuple{F}, Tuple{Any, F, Vararg{Any, 18}}} where F" href="#SindbadML.getLossForSites-Union{Tuple{F}, Tuple{Any, F, Vararg{Any, 18}}} where F"><span class="jlbinding">SindbadML.getLossForSites</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getLossForSites</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(gradient_lib, loss_function</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">F</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, loss_array_sites, loss_array_split, epoch_number, scaled_params, sites_list, indices_sites, models, space_forcing, space_spinup_forcing, loc_forcing_t, space_output, loc_land, tem_info, param_to_index, parameter_scaling_type, space_observations, cost_options, constraint_method) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">where</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {F}</span></span></code></pre></div><p>Calculates the loss for all sites. The loss is calculated using the <code>loss_function</code> function. The <code>loss_array_sites</code> and <code>loss_array_split</code> arrays are updated with the loss values. The <code>loss_array_sites</code> array stores the loss values for each site and epoch, while the <code>loss_array_split</code> array stores the loss values for each model output and epoch.</p><p><strong>Arguments</strong></p><ul><li><p><code>gradient_lib</code>: gradient library</p></li><li><p><code>loss_function</code>: loss function</p></li><li><p><code>loss_array_sites</code>: array to store the loss values for each site and epoch</p></li><li><p><code>loss_array_split</code>: array to store the loss values for each model output and epoch</p></li><li><p><code>epoch_number</code>: epoch number</p></li><li><p><code>scaled_params</code>: scaled parameters</p></li><li><p><code>sites_list</code>: list of sites</p></li><li><p><code>indices_sites</code>: indices of sites</p></li><li><p><code>models</code>: list of models</p></li><li><p><code>space_forcing</code>: forcing data location</p></li><li><p><code>space_spinup_forcing</code>: spinup forcing data location</p></li><li><p><code>loc_forcing_t</code>: forcing data time for one time step.</p></li><li><p><code>space_output</code>: output data location</p></li><li><p><code>loc_land</code>: initial land state</p></li><li><p><code>tem_info</code>: model information</p></li><li><p><code>param_to_index</code>: parameter to index</p></li><li><p><code>space_observations</code>: observation data location</p></li><li><p><code>cost_options</code>: cost options</p></li><li><p><code>constraint_method</code>: constraint method</p></li></ul></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.getParamsAct-Tuple{Any, Any}" href="#SindbadML.getParamsAct-Tuple{Any, Any}"><span class="jlbinding">SindbadML.getParamsAct</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getParamsAct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, tbl_params)</span></span></code></pre></div><p>Scales <code>x</code> values in the [0,1] interval to some given lower <code>lo_b</code> and upper <code>up_b</code> bounds.</p><p><strong>Arguments</strong></p><ul><li><p><code>x</code>: vector array</p></li><li><p><code>tbl_params</code>: a Table with input fields <code>default</code>, <code>lower</code> and <code>upper</code> that match the <code>x</code> vector.</p></li></ul><p>Returns a vector array with new values scaled into the new interval <code>[lower, upper]</code>.</p></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.getPullback" href="#SindbadML.getPullback"><span class="jlbinding">SindbadML.getPullback</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getPullback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(flat, re, features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">AbstractArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getPullback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(flat, re, features</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Tuple</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>Arguments:</strong></p><ul><li><p>flat :: weight parameters.</p></li><li><p>re :: model structure (vanilla Chain Dense Layers).</p></li><li><p>features :: <code>n</code> predictors and <code>s</code> samples.</p><ul><li><p>A vector of predictors</p></li><li><p>A matrix of predictors: <code>(p_n x s)</code></p></li><li><p>A tuple vector of predictors: <code>(p1, p2)</code></p></li><li><p>A tuple of matrices of predictors: <code>[(p1_n x s), (p2_n x s)]</code></p></li></ul></li></ul><p><strong>Returns:</strong></p><ul><li>new parameters and pullback function</li></ul><p><strong>Example</strong></p><p>Here we do one input features vector or matrix.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SindbadML</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Flux</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># model</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Chain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, relu), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), Flux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sigmoid)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># features</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">_feat </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Float32, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># apply</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flat, re </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> destructureNN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(m)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Zygote</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">new_params, pullback_func </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> getPullback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(flat, re, _feat)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ? or</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">_feat_ns </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Float32, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># `n` predictors and `s` samples.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">new_params, pullback_func </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> getPullback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(flat, re, _feat_ns)</span></span></code></pre></div><p><strong>Example</strong></p><p>Here we do one multiple input features vector or matrix.</p><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SindbadML</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">using</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> Flux</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># model</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Chain</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, relu), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), Flux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sigmoid)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">m2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Dense</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Flux</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sigmoid)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">combo_ms </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> JoinDenseNN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((m1, m2))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># features</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">_feat1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Float32, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">_feat2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Float32, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># apply</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">flat, re </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> destructureNN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(combo_ms)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Zygote</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">new_params, pullback_func </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> getPullback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(flat, re, (_feat1, _feat2))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># ? or with multiple samples</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">_feat1_ns </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Float32, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># `n` predictors and `s` samples.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">_feat2_ns </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(Float32, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># `n` predictors and `s` samples.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">new_params, pullback_func </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> getPullback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(flat, re, (_feat1_ns, _feat2_ns))</span></span></code></pre></div></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.gradientBatchPolyester!-Tuple{ForwardDiffGrad, Any, Int64, Function, Function, Vararg{Any}}" href="#SindbadML.gradientBatchPolyester!-Tuple{ForwardDiffGrad, Any, Int64, Function, Function, Vararg{Any}}"><span class="jlbinding">SindbadML.gradientBatchPolyester!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradientBatchPolyester!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(grads_lib</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ForwardDiffGrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, dx_batch, chunk_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, loss_f</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, get_inner_args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Function</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, input_args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; showprog</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>Computes gradients for a batch of samples.</strong></p><p><strong>Arguments</strong></p><ul><li><p><code>grads_lib</code>: uses ForwardDiff.jl for gradients computation.</p></li><li><p><code>dx_batch</code>: pre-allocated array for batched gradients.</p></li><li><p><code>chunk_size</code>: Int, chunk size for PolyesterForwardDiff&#39;s threads.</p></li><li><p><code>loss_f</code>: loss function to be applied.</p></li><li><p><code>get_inner_args</code>: function to obtain inner values of loss function.</p></li><li><p><code>input_args</code>: global input arguments.</p></li></ul><p><strong>Returns:</strong></p><p>A <code>n x m</code> matrix for <code>n parameters gradients</code> and <code>m</code> samples.</p></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.gradientPolyester-Union{Tuple{F}, Tuple{ForwardDiffGrad, Any, Int64, F, Vararg{Any}}} where F" href="#SindbadML.gradientPolyester-Union{Tuple{F}, Tuple{ForwardDiffGrad, Any, Int64, F, Vararg{Any}}} where F"><span class="jlbinding">SindbadML.gradientPolyester</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradientPolyester</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(grads_lib</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ForwardDiffGrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, x_vals, chunk_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, loss</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">F</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Computes gradients using <code>PolyesterForwardDiff.jl</code> for multi-threaded chunk splits. The optimal speed is ideally achieved with <code>one thread</code> when <code>chunk_size=1</code> and <code>n-threads</code> for <code>n</code> parameters. However, a good compromise between memory allocations and speed could be to set <code>chunk_size=3</code> and use <code>n-threads</code> for <code>2n parameters</code>.</p><p><strong>Arguments</strong></p><ul><li><p><code>grads_lib</code>: uses ForwardDiff.jl for gradients computation.</p></li><li><p><code>x_vals</code>: parameters values.</p></li><li><p><code>chunk_size</code>: Int, chunk size for PolyesterForwardDiff&#39;s threads.</p></li><li><p><code>loss_f</code>: loss function to be applied.</p></li><li><p><code>args...</code>: additional arguments for the loss function.</p></li></ul><div class="warning custom-block"><p class="custom-block-title">Warning</p><p>For M1 systems we default to ForwardDiff.gradient! single-threaded. And we let the <code>GradientConfig</code> constructor to automatically select the appropriate <code>chunk_size</code>.</p></div><p>Returns: a <code>∇x</code> array with all parameter&#39;s gradients.</p></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.gradsNaNCheck!-NTuple{4, Any}" href="#SindbadML.gradsNaNCheck!-NTuple{4, Any}"><span class="jlbinding">SindbadML.gradsNaNCheck!</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">gradsNaNCheck!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(grads_batch, _params_batch, sites_batch, tbl_params; show_params_for_nan</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">false</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Utility function to check if some calculated gradients were NaN (if found please double check your approach). This function will replace those NaNs with 0.0f0.</p><p><strong>Arguments</strong></p><ul><li><p><code>grads_batch</code>: gradients array.</p></li><li><p><code>_params_batch</code>: parameters values.</p></li><li><p><code>sites_batch</code>: sites names.</p></li><li><p><code>tbl_params</code>: parameters table.</p></li><li><p><code>show_params_for_nan=false</code>: if true, it will show the parameters that caused the NaNs.</p></li></ul></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.lcKAoneHotbatch-NTuple{4, Any}" href="#SindbadML.lcKAoneHotbatch-NTuple{4, Any}"><span class="jlbinding">SindbadML.lcKAoneHotbatch</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lcKAoneHotbatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(lc_data, up_bound, lc_name, ka_labels)</span></span></code></pre></div><p><strong>Arguments</strong></p><ul><li><p><code>lc_data</code>: Vector array</p></li><li><p><code>up_bound</code>: last index class, the range goes from <code>1:up_bound</code>, and any case not in that range uses the <code>up_bound</code> value. For <code>PFT</code> use <code>17</code> and for <code>KG</code> <code>32</code>.</p></li><li><p><code>lc_name</code>: land cover approach, either <code>KG</code> or <code>PFT</code>.</p></li><li><p><code>ka_labels</code>: KeyedArray labels, i.e. site names</p></li></ul></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.loadTrainedNN-Tuple{Any}" href="#SindbadML.loadTrainedNN-Tuple{Any}"><span class="jlbinding">SindbadML.loadTrainedNN</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">loadTrainedNN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(path_model)</span></span></code></pre></div><p><strong>Arguments</strong></p><ul><li><code>path_model</code>: path to the model.</li></ul></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.lossSite-NTuple{14, Any}" href="#SindbadML.lossSite-NTuple{14, Any}"><span class="jlbinding">SindbadML.lossSite</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">lossSite</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(new_params, gradient_lib, models, loc_forcing, loc_spinup_forcing, loc_forcing_t, loc_output, land_init, tem_info, param_to_index, parameter_scaling_type, loc_obs, cost_options, constraint_method; optim_mode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Function to calculate the loss for a given site. This is used for optimization, hence the <code>optim_mode</code> argument is set to <code>true</code> by default. Also, a gradient library should be set as well as new parameters to update the models. See all input arguments in the function:</p><p><strong>Arguments</strong></p><ul><li><p><code>new_params</code>: new parameters</p></li><li><p><code>gradient_lib</code>: gradient library</p></li><li><p><code>models</code>: list of models</p></li><li><p><code>loc_forcing</code>: forcing data location</p></li><li><p><code>loc_spinup_forcing</code>: spinup forcing data location</p></li><li><p><code>loc_forcing_t</code>: forcing data time for one time step.</p></li><li><p><code>loc_output</code>: output data location</p></li><li><p><code>land_init</code>: initial land state</p></li><li><p><code>tem_info</code>: model information</p></li><li><p><code>param_to_index</code>: parameter to index</p></li><li><p><code>loc_obs</code>: observation data location</p></li><li><p><code>cost_options</code>: cost options</p></li><li><p><code>constraint_method</code>: constraint method</p></li></ul></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.mixedGradientTraining-NTuple{7, Any}" href="#SindbadML.mixedGradientTraining-NTuple{7, Any}"><span class="jlbinding">SindbadML.mixedGradientTraining</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">mixedGradientTraining</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(grads_lib, nn_model, train_refs, test_val_refs, loss_fargs, forward_args; n_epochs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, optimizer</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Optimisers</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Adam</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(), path_experiment</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Training function that computes model parameters using a neural network, which are then used by process-based models (PBMs) to estimate parameter gradients. Neural network weights are updated using the product of these gradients with the neural network&#39;s Jacobian.</p><p><strong>Arguments</strong></p><ul><li><p><code>grads_lib</code>: Library to compute PBMs parameter gradients.</p></li><li><p><code>nn_model</code>: A <code>Flux.Chain</code> neural network.</p></li><li><p><code>train_refs</code>: training data features.</p></li><li><p><code>test_val_refs</code>: test and validation data features.</p></li><li><p><code>loss_fargs</code>: functions used to calculate the loss.</p></li><li><p><code>forward_args</code>: arguments to evaluate the PBMs.</p></li><li><p><code>path_experiment=&quot;/&quot;</code>: save model to path.</p></li></ul></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.oneHotPFT-Tuple{Any, Any, Any}" href="#SindbadML.oneHotPFT-Tuple{Any, Any, Any}"><span class="jlbinding">SindbadML.oneHotPFT</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">oneHotPFT</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pft, up_bound, veg_class)</span></span></code></pre></div><p><strong>Arguments</strong></p><ul><li><p><code>pft</code>: (Plant Functional Type). Any entry not in 1:17 would be set to the last index, this includes NaN! Last index is water/NaN</p></li><li><p><code>up_bound</code>: last index class, the range goes from <code>1:up_bound</code>, and any case not in that range uses the <code>up_bound</code> value. For <code>PFT</code> use <code>17</code>.</p></li><li><p><code>veg_class</code>: <code>true</code> or <code>false</code>.</p></li></ul><p>Returns a vector.</p></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.partitionBatches-Tuple{Any}" href="#SindbadML.partitionBatches-Tuple{Any}"><span class="jlbinding">SindbadML.partitionBatches</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">partitionBatches</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(n; batch_size</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">32</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Return an Iterator partitioning a dataset into batches.</p><p><strong>Arguments</strong></p><ul><li><p><code>n</code>: number of samples</p></li><li><p><code>batch_size</code>: batch size</p></li></ul></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.shuffleBatches-Tuple{Any, Any}" href="#SindbadML.shuffleBatches-Tuple{Any, Any}"><span class="jlbinding">SindbadML.shuffleBatches</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">shuffleBatches</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(list, bs; seed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>Arguments</strong></p><ul><li><p><code>bs</code>: Batch size</p></li><li><p><code>list</code>: an array of samples</p></li><li><p><code>seed</code>: Int</p></li></ul><p>Returns shuffled partitioned batches.</p></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.shuffleList-Tuple{Any}" href="#SindbadML.shuffleList-Tuple{Any}"><span class="jlbinding">SindbadML.shuffleList</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">shuffleList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(list; seed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p><strong>Arguments</strong></p><ul><li><p><code>list</code>: an array of samples</p></li><li><p><code>seed</code>: Int</p></li></ul></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.siteNameToID-Tuple{Any, Any}" href="#SindbadML.siteNameToID-Tuple{Any, Any}"><span class="jlbinding">SindbadML.siteNameToID</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">siteNameToID</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(site_name, sites_list)</span></span></code></pre></div><p>Returns the index of <code>site_name</code> in the <code>sites_list</code></p><p><strong>Arguments</strong></p><ul><li><p><code>site_name</code>: site name</p></li><li><p><code>sites_list</code>: list of site names</p></li></ul></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.toClass-Tuple{Number}" href="#SindbadML.toClass-Tuple{Number}"><span class="jlbinding">SindbadML.toClass</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">toClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">Number</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; vegetation_rules)</span></span></code></pre></div><p><strong>Arguments</strong></p><ul><li><p><code>x</code>: a key <code>(Number)</code> from <code>vegetation_rules</code></p></li><li><p><code>vegetation_rules</code></p></li></ul></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.vegKAoneHotbatch-Tuple{Any, Any}" href="#SindbadML.vegKAoneHotbatch-Tuple{Any, Any}"><span class="jlbinding">SindbadML.vegKAoneHotbatch</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">vegKAoneHotbatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pft_data, ka_labels)</span></span></code></pre></div><p><strong>Arguments</strong></p><ul><li><p><code>pft_data</code>: Vector array</p></li><li><p><code>ka_labels</code>: KeyedArray labels, i.e. site names</p></li></ul></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.vegOneHot-Tuple{Any}" href="#SindbadML.vegOneHot-Tuple{Any}"><span class="jlbinding">SindbadML.vegOneHot</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">vegOneHot</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(v_class; vegetation_labels)</span></span></code></pre></div><p><strong>Arguments</strong></p><ul><li><p><code>v_class</code>: get it by doing <code>toClass(x; vegetation_rules)</code>.</p></li><li><p><code>vegetation_labels</code>: see them by typing <code>vegetation_labels</code>.</p></li></ul></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.vegOneHotbatch-Tuple{Any}" href="#SindbadML.vegOneHotbatch-Tuple{Any}"><span class="jlbinding">SindbadML.vegOneHotbatch</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">vegOneHotbatch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(veg_classes; vegetation_labels)</span></span></code></pre></div><p><strong>Arguments</strong></p><ul><li><p>veg_classes: get these from <code>toClass.([x1, x2,...])</code></p></li><li><p>vegetation_labels: see them by typing <code>vegetation_labels</code></p></li></ul></details><h2 id="internal" tabindex="-1">Internal <a class="header-anchor" href="#internal" aria-label="Permalink to &quot;Internal&quot;">​</a></h2><details class="jldocstring custom-block" open><summary><a id="SindbadML.batchShuffler-Tuple{Any, Any, Any}" href="#SindbadML.batchShuffler-Tuple{Any, Any, Any}"><span class="jlbinding">SindbadML.batchShuffler</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">batchShuffler</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x_forcings, ids_forcings, batch_size; bs_seed</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1456</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Shuffles the batches of forcings and their corresponding indices.</p></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.getCacheFromOutput" href="#SindbadML.getCacheFromOutput"><span class="jlbinding">SindbadML.getCacheFromOutput</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getCacheFromOutput</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(loc_output, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ForwardDiffGrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getCacheFromOutput</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(loc_output, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FiniteDiff</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getCacheFromOutput</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(loc_output, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FiniteDifferences</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Returns the appropriate Cache type based on the automatic differentiation or finite differences package being used.</p><p><strong>Arguments</strong></p><ul><li><p><code>loc_output</code>: The local output</p></li><li><p>Second argument specifies the differentiation method:</p><ul><li><p><code>ForwardDiffGrad</code>: Uses ForwardDiff.jl for automatic differentiation</p></li><li><p><code>FiniteDiff</code>: Uses FiniteDiff.jl for finite difference calculations</p></li><li><p><code>FiniteDifferences</code>: Uses FiniteDifferences.jl for finite difference calculations</p></li></ul></li></ul></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.getLoss-NTuple{10, Any}" href="#SindbadML.getLoss-NTuple{10, Any}"><span class="jlbinding">SindbadML.getLoss</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getLoss</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(models, loc_forcing, loc_spinup_forcing, loc_forcing_t, loc_output, land_init, tem_info, loc_obs, cost_options, constraint_method; optim_mode</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Calculates the loss for a given site. At this stage model parameters should had been set. The loss is calculated using the <code>metricVector</code> and <code>combineMetric</code> functions. The <code>metricVector</code> function calculates the loss for each model output and the <code>combineMetric</code> function combines the losses into a single value.</p><p><strong>Arguments</strong></p><ul><li><p><code>models</code>: list of models</p></li><li><p><code>loc_forcing</code>: forcing data location</p></li><li><p><code>loc_spinup_forcing</code>: spinup forcing data location</p></li><li><p><code>loc_forcing_t</code>: forcing data time for one time step.</p></li><li><p><code>loc_output</code>: output data location</p></li><li><p><code>land_init</code>: initial land state</p></li><li><p><code>tem_info</code>: model information</p></li><li><p><code>loc_obs</code>: observation data location</p></li><li><p><code>cost_options</code>: cost options</p></li><li><p><code>constraint_method</code>: constraint method</p></li></ul><p>The optional argument <code>optim_mode</code> is used to return the loss value only when set to <code>true</code>. Otherwise, it returns the loss value, the loss vector, and the loss indices.</p></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.getOutputFromCache" href="#SindbadML.getOutputFromCache"><span class="jlbinding">SindbadML.getOutputFromCache</span></a> <span class="VPBadge info jlObjectType jlFunction"><!--[-->Function<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getOutputFromCache</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(loc_output, _, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FiniteDiffGrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getOutputFromCache</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(loc_output, _, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">FiniteDifferencesGrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">getOutputFromCache</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(loc_output, new_params, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">::</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">ForwardDiffGrad</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Retrieves output values from <code>Cache</code> based on the differentiation method being used.</p><p><strong>Arguments</strong></p><ul><li><p><code>loc_output</code>: The cached output values</p></li><li><p><code>_</code> or <code>new_params</code>: Additional parameters (only used with ForwardDiff)</p></li><li><p>Third argument specifies the differentiation method:</p><ul><li><p><code>FiniteDiffGrad</code>: Returns cached output directly when using FiniteDiff.jl</p></li><li><p><code>FiniteDifferencesGrad</code>: Returns cached output directly when using FiniteDifferences.jl</p></li><li><p><code>ForwardDiffGrad</code>: Processes cached output with new parameters when using ForwardDiff.jl, returns <code>get_tmp.(loc_output, (new_params,))</code></p></li></ul></li></ul></details><details class="jldocstring custom-block" open><summary><a id="SindbadML.scaleToBounds-Tuple{Any, Any, Any}" href="#SindbadML.scaleToBounds-Tuple{Any, Any, Any}"><span class="jlbinding">SindbadML.scaleToBounds</span></a> <span class="VPBadge info jlObjectType jlMethod"><!--[-->Method<!--]--></span></summary><div class="language-julia vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">julia</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">scaleToBounds</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(x, lo_b, up_b)</span></span></code></pre></div><p>Scales values in the [0,1] interval to some given lower <code>lo_b</code> and upper <code>up_b</code> bounds.</p><p><strong>Arguments</strong></p><ul><li><p><code>x</code>: vector array</p></li><li><p><code>lo_b</code>: lower bound</p></li><li><p><code>up_b</code>: upper bound</p></li></ul></details></div></div></main><footer class="VPDocFooter" data-v-83890dd9 data-v-4f9813fa><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-4f9813fa><span class="visually-hidden" id="doc-footer-aria-label" data-v-4f9813fa>Pager</span><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link prev" href="/Sindbad/pages/code/metrics" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Previous page</span><span class="title" data-v-4f9813fa> + Metrics</span><!--]--></a></div><div class="pager" data-v-4f9813fa><a class="VPLink link pager-link next" href="/Sindbad/pages/code/models" data-v-4f9813fa><!--[--><span class="desc" data-v-4f9813fa>Next page</span><span class="title" data-v-4f9813fa> + Models</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-a9a9e638 data-v-c970a860><div class="container" data-v-c970a860><p class="message" data-v-c970a860><a href="https://www.bgc-jena.mpg.de/en" target="_blank"><img src="logo_mpi_grey.png" class="footer-logo" alt="MPI Logo"/></a></p><p class="copyright" data-v-c970a860><span>Powered by the <a href="https://julialang.org" target="_blank">Julia Programming Language</a></span><span>© Copyright 2023 <strong>SINDBAD Development Team</strong></span></p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"index.md\":\"DVJnKMpo\",\"pages_about_citation.md\":\"B1LLF5BL\",\"pages_about_contact.md\":\"zyECJF5R\",\"pages_about_license.md\":\"DA60izaT\",\"pages_about_publications.md\":\"BXNJu5AL\",\"pages_about_support.md\":\"BBj9ZjNp\",\"pages_about_team.md\":\"B4X15oBm\",\"pages_code_data.md\":\"Cs4U7_8r\",\"pages_code_experiment.md\":\"BRbTNLok\",\"pages_code_metrics.md\":\"kSngCq_L\",\"pages_code_ml.md\":\"Bs-fMNT9\",\"pages_code_models.md\":\"C6lNQ2BG\",\"pages_code_optimization.md\":\"BMftF1ck\",\"pages_code_setup.md\":\"DpZxSDrF\",\"pages_code_sindbad.md\":\"V4Nr5Kfb\",\"pages_code_tem.md\":\"oLmlS2Fl\",\"pages_code_utils.md\":\"6qT9DWyx\",\"pages_code_visuals.md\":\"iJMBntpk\",\"pages_concept_experiment.md\":\"BnfurNFr\",\"pages_concept_info.md\":\"DKyhMscm\",\"pages_concept_land.md\":\"ChRMeMG9\",\"pages_concept_overview.md\":\"DF_YRQmU\",\"pages_concept_tem.md\":\"CoRyeYL9\",\"pages_manual_array_handling.md\":\"wNarC9sP\",\"pages_manual_conventions.md\":\"C5tprMEH\",\"pages_manual_costmetrics.md\":\"sDOtfQ6u\",\"pages_manual_experiments.md\":\"B0aPH3hS\",\"pages_manual_how_to_doc.md\":\"Cf_MSMsX\",\"pages_manual_install.md\":\"C2iPBgBX\",\"pages_manual_overview.md\":\"vQ_te84b\",\"pages_manual_spinup.md\":\"DnP_zasn\",\"pages_manual_toy_model.md\":\"Jn9wKFYG\",\"pages_settings_experiment.md\":\"_bnrGPQZ\",\"pages_settings_forcing.md\":\"DhZZ7bf1\",\"pages_settings_model_structure.md\":\"Yos0mLOw\",\"pages_settings_optimization.md\":\"BIpkAZIY\",\"pages_settings_overview.md\":\"C2Pwc6tj\",\"pages_settings_parameters.md\":\"B_qQQmOQ\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"SINDBAD\",\"description\":\"A model data integration framework\",\"base\":\"/Sindbad/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"outline\":\"deep\",\"logo\":{\"src\":\"/logo.png\",\"width\":24,\"height\":24},\"search\":{\"provider\":\"local\",\"options\":{\"detailedView\":true}},\"nav\":[{\"text\":\"Concept\",\"items\":[{\"text\":\"SINDBAD\",\"link\":\"/pages/concept/overview\"},{\"text\":\"Experiment\",\"link\":\"/pages/concept/experiment\"},{\"text\":\"TEM\",\"link\":\"/pages/concept/TEM\"},{\"text\":\"info\",\"link\":\"/pages/concept/info\"},{\"text\":\"land\",\"link\":\"/pages/concept/land\"}]},{\"text\":\"Manual\",\"items\":[{\"text\":\"Array Handling\",\"link\":\"/pages/manual/array_handling\"},{\"text\":\"Experiments\",\"link\":\"/pages/manual/experiments\"},{\"text\":\"Modeling Convention\",\"link\":\"/pages/manual/conventions\"},{\"text\":\"Spinup\",\"link\":\"/pages/manual/spinup\"},{\"text\":\"Toy Model\",\"link\":\"/pages/manual/toy_model\"},{\"text\":\"Install\",\"link\":\"/pages/manual/install\"}]},{\"text\":\"Settings\",\"items\":[{\"text\":\"Overview\",\"link\":\"/pages/settings/overview\"},{\"text\":\"Experiments\",\"link\":\"/pages/settings/experiment\"},{\"text\":\"Forcing\",\"link\":\"/pages/settings/forcing\"},{\"text\":\"Models\",\"link\":\"/pages/settings/model_structure\"},{\"text\":\"Optimization\",\"link\":\"/pages/settings/optimization\"},{\"text\":\"Parameters\",\"link\":\"/pages/settings/parameters\"}]},{\"text\":\"Code\",\"items\":[{\"text\":\"Sindbad\",\"link\":\"/pages/code/sindbad\"},{\"text\":\" + Data\",\"link\":\"/pages/code/data\"},{\"text\":\" + Experiment\",\"link\":\"/pages/code/experiment\"},{\"text\":\" + Metrics\",\"link\":\"/pages/code/metrics\"},{\"text\":\" + ML\",\"link\":\"/pages/code/ml\"},{\"text\":\" + Models\",\"link\":\"/pages/code/models\"},{\"text\":\" + Optimization\",\"link\":\"/pages/code/optimization\"},{\"text\":\" + Setup\",\"link\":\"/pages/code/setup\"},{\"text\":\" + TEM\",\"link\":\"/pages/code/tem\"},{\"text\":\" + Utils\",\"link\":\"/pages/code/utils\"},{\"text\":\" + Visuals\",\"link\":\"/pages/code/visuals\"}]},{\"text\":\"About\",\"items\":[{\"text\":\"Contact\",\"link\":\"/pages/about/contact\"},{\"text\":\"License\",\"link\":\"/pages/about/license\"},{\"text\":\"Publications\",\"link\":\"/pages/about/publications\"},{\"text\":\"Support\",\"link\":\"/pages/about/support\"},{\"text\":\"Team\",\"link\":\"/pages/about/team\"}]},{\"component\":\"VersionPicker\"}],\"sidebar\":[{\"text\":\"Concept\",\"items\":[{\"text\":\"SINDBAD\",\"link\":\"/pages/concept/overview\"},{\"text\":\"Experiment\",\"link\":\"/pages/concept/experiment\"},{\"text\":\"TEM\",\"link\":\"/pages/concept/TEM\"},{\"text\":\"info\",\"link\":\"/pages/concept/info\"},{\"text\":\"land\",\"link\":\"/pages/concept/land\"}]},{\"text\":\"Manual\",\"items\":[{\"text\":\"Array Handling\",\"link\":\"/pages/manual/array_handling\"},{\"text\":\"Experiments\",\"link\":\"/pages/manual/experiments\"},{\"text\":\"Modeling Convention\",\"link\":\"/pages/manual/conventions\"},{\"text\":\"Spinup\",\"link\":\"/pages/manual/spinup\"},{\"text\":\"Toy Model\",\"link\":\"/pages/manual/toy_model\"},{\"text\":\"Install\",\"link\":\"/pages/manual/install\"}]},{\"text\":\"Settings\",\"items\":[{\"text\":\"Overview\",\"link\":\"/pages/settings/overview\"},{\"text\":\"Experiments\",\"link\":\"/pages/settings/experiment\"},{\"text\":\"Forcing\",\"link\":\"/pages/settings/forcing\"},{\"text\":\"Models\",\"link\":\"/pages/settings/model_structure\"},{\"text\":\"Optimization\",\"link\":\"/pages/settings/optimization\"},{\"text\":\"Parameters\",\"link\":\"/pages/settings/parameters\"}]},{\"text\":\"Code\",\"collapsed\":true,\"items\":[{\"text\":\"Sindbad\",\"link\":\"/pages/code/sindbad\"},{\"text\":\" + Data\",\"link\":\"/pages/code/data\"},{\"text\":\" + Experiment\",\"link\":\"/pages/code/experiment\"},{\"text\":\" + Metrics\",\"link\":\"/pages/code/metrics\"},{\"text\":\" + ML\",\"link\":\"/pages/code/ml\"},{\"text\":\" + Models\",\"link\":\"/pages/code/models\"},{\"text\":\" + Optimization\",\"link\":\"/pages/code/optimization\"},{\"text\":\" + Setup\",\"link\":\"/pages/code/setup\"},{\"text\":\" + TEM\",\"link\":\"/pages/code/tem\"},{\"text\":\" + Utils\",\"link\":\"/pages/code/utils\"},{\"text\":\" + Visuals\",\"link\":\"/pages/code/visuals\"}]},{\"text\":\"About\",\"items\":[{\"text\":\"Contact\",\"link\":\"/pages/about/contact\"},{\"text\":\"License\",\"link\":\"/pages/about/license\"},{\"text\":\"Publications\",\"link\":\"/pages/about/publications\"},{\"text\":\"Support\",\"link\":\"/pages/about/support\"},{\"text\":\"Team\",\"link\":\"/pages/about/team\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/EarthyScience/SINDBAD\",\"ariaLabel\":\"repo address\"}],\"footer\":{\"message\":\"<a href=\\\"https://www.bgc-jena.mpg.de/en\\\" target=\\\"_blank\\\"><img src=\\\"logo_mpi_grey.png\\\" class=\\\"footer-logo\\\" alt=\\\"MPI Logo\\\"/></a>\",\"copyright\":\"<span>Powered by the <a href=\\\"https://julialang.org\\\" target=\\\"_blank\\\">Julia Programming Language</a></span><span>© Copyright 2023 <strong>SINDBAD Development Team</strong></span>\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true}");</script>
    
  </body>
</html>